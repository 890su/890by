# IE Mode Setup for Microsoft Edge

Скрипт автоматической настройки режима Internet Explorer в Microsoft Edge для работы с белорусскими государственными порталами.

## Проблема

После обновления Microsoft Edge (февраль 2026) режим IE перестал работать у многих пользователей. Белорусские госпорталы (ФСЗН, МНС, ЭСЧФ, Белстат) требуют IE mode для корректной работы с ЭЦП и сертификатами.

## Что делает скрипт

1. **Создаёт список сайтов** для IE mode (`C:\ProgramData\ie-site-list.xml`)
2. **Прописывает политику Edge** — указывает на список сайтов через реестр

Для добавления порталов в надёжные узлы используйте отдельный скрипт [ie-portals-setup](../ie-portals-setup/).

## Поддерживаемые порталы

- `portal.ssf.gov.by` — Портал ФСЗН
- `portal2.ssf.gov.by` — Портал ФСЗН (резервный)
- `portal.nalog.gov.by` — Портал МНС
- `portal.vat.gov.by` — Портал ЭСЧФ
- `vat.gov.by` — ЭСЧФ
- `e-respondent.belstat.gov.by` — Белстат
- `oauth.uas.nces.by` — Авторизация НЦЭУ
- `usd.nces.by` — НЦЭУ

## Быстрый запуск (одна команда)

Откройте **PowerShell от администратора** и вставьте:

```powershell
irm https://raw.githubusercontent.com/890by/support-tools/main/edge-ie-mode/edge-ie-mode.ps1 | iex
```

## Запуск через .bat

**Из скачанного архива:**

1. Скачайте репозиторий (Code → Download ZIP)
2. Распакуйте
3. Откройте папку `edge-ie-mode`
4. Запустите **run.bat** правой кнопкой → **Запуск от имени администратора**

**Онлайн (актуальная версия):** запустите **run-online.bat** — скрипт скачается с GitHub и выполнится.

## Проверка после запуска

1. Перезапустите Microsoft Edge
2. Откройте `edge://compat/iediagnostic`
3. Убедитесь что поле **«Источник эффективного списка сайтов»** показывает:
   ```
   file:///C:/ProgramData/ie-site-list.xml
   ```
4. Откройте один из порталов — он должен автоматически открыться в IE mode

## Требования

- Windows 10 / 11
- Microsoft Edge (Chromium)
- Права администратора
- Internet Explorer включён в компонентах Windows

## Если не помогло

- Убедитесь что IE включён: **Панель управления → Программы → Включение/отключение компонентов Windows → Internet Explorer 11**
- Проверьте что Edge установлен системно (не в профиле пользователя)
- Попробуйте переустановить Edge: `installer.exe --system-level`

## Лицензия

MIT
